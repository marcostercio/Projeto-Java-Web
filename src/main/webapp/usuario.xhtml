<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<link type="text/css" rel="stylesheet" href="../resources/estilo.css" />
</h:head>
<h:body>
	<h:graphicImage url="../resources/img/logo_size.jpg" />
	<p:menubar>
		<p:menuitem value="Home" url="feed.xhtml"></p:menuitem>
		<p:menuitem value="Painel do Usuário" url="usuario.xhtml"></p:menuitem>
		<p:menuitem value="Postagem" url="postagem.xhtml"></p:menuitem>

	</p:menubar>

	<h:form id="formdados">
		<p:messages showDetail="true" showSumary="false" id="msg" />
		<p:panelGrid columns="2">
			<!-- teremos que restringir futuramente -->
			<p:outputLabel>
				<p:selectOneMenu
					value="#{usuarioManagedBean.usuarioPessoa.tipoperfil}">
					<f:selectItem itemValue="Usu" itemLabel="Usuário" />
					<f:selectItem itemValue="Prof" itemLabel="Professor" />
					<f:selectItem itemValue="Adm" itemLabel="Administrador" />
				</p:selectOneMenu>
			</p:outputLabel>

			<p:outputLabel>Nome</p:outputLabel>
			<p:inputText value="#{usuarioManagedBean.usuarioPessoa.nome}"
				required="true" requiredMessage="Nome é obrigatório!" />
			<p:outputLabel>Sobrenome</p:outputLabel>
			<p:inputText value="#{usuarioManagedBean.usuarioPessoa.sobrenome}" />
			<p:outputLabel>E-mail</p:outputLabel>
			<p:inputText value="#{usuarioManagedBean.usuarioPessoa.email}" />
			<p:outputLabel>CPF</p:outputLabel>
			<p:inputMask mask="999.999.999-99"
				value="#{usuarioManagedBean.usuarioPessoa.cpf}" />
				
			<p:outputLabel>Senha</p:outputLabel>
			<p:password  id="inlineFeedback" feedback="true" inline="true"
				value="#{usuarioManagedBean.usuarioPessoa.senha}" />

		</p:panelGrid>
		<p:commandButton value="Salvar" action="#{usuarioManagedBean.salvar}"
			ajax="false" />
		<p:button value="Novo" action="#{usuarioManagedBean.novo}" />
	</h:form>

	<h:form>
		<p:panel header="Consultar Usuário">
			<div class="p-field">
				<p:panelGrid columns="3">

					<h:outputLabel value="Nome:" />
					<p:inputText value="#{usuarioManagedBean.pesquisa}" />
					<p:commandButton value="Buscar"
						actionListener="#{usuarioManagedBean.pesquisar}"
						update="formtabela" />

				</p:panelGrid>
			</div>
		</p:panel>
	</h:form>

	<h:form id="formtabela">
		<p:dataTable value="#{usuarioManagedBean.list}" var="usu">
			<p:column headerText="Id">
				<h:outputText value="#{usu.id}" />
			</p:column>
			<p:column headerText="Tipo">
				<h:outputText value="#{usu.tipoperfil}" />
			</p:column>
			<p:column headerText="Nome">
				<h:outputText value="#{usu.nome}" />
			</p:column>
			
			<p:column headerText="Sobrenome">
				<h:outputText value="#{usu.sobrenome}" />
			</p:column>

			<p:column headerText="E-mail">
				<h:outputText value="#{usu.email}" />
			</p:column>
			<p:column headerText="CPF">
				<h:outputText value="#{usu.cpf}" />
			</p:column>
			<!-- botao editar -->
			<p:column >
				<h:commandLink immediate="true" id="botaoeditar">
					<h:graphicImage url="../resources/img/editar-mensagem.png" />
					<f:setPropertyActionListener
						target="#{usuarioManagedBean.usuarioPessoa}" value="#{usu}" />
					<f:ajax execute="botaoeditar" render=":formdados" />
				</h:commandLink>
			</p:column>
			<!-- botao excluir -->
			<p:column headerText="Ações">

				<h:commandLink id="botaoexcluir" immediate="true"
					action="#{usuarioManagedBean.deletarID}">
					<h:graphicImage url="../resources/img/deletar-usuario.png" />
					<f:ajax execute="botaoexcluir" render="@form :formdados:msg" />
					<f:setPropertyActionListener value="#{usu}"
						target="#{usuarioManagedBean.usuarioPessoa}" />
				</h:commandLink>
			</p:column>
			<!-- botao telefone -->
			<p:column>
				<h:commandLink imediate="true" action="telefone.xhtml"
					id="botaotelefone">
					<h:graphicImage url="../resources/img/fone.png" width="20"
						height="20" />
					<f:param name="codigousuario" value="#{usu.id}" />
				</h:commandLink>
			</p:column>
		</p:dataTable>
	</h:form>
</h:body>

</html>